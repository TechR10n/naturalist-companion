<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="710px" preserveAspectRatio="none" style="width:2028px;height:710px;background:#FFFFFF;" version="1.1" viewBox="0 0 2028 710" width="2028.3333px" zoomAndPan="magnify"><title>Camera &#8594; Geology (iPhone &#8594; Vertex AI) &#8212; Reference Architecture</title><defs/><g><g class="title" data-source-line="2"><text fill="#000000" font-family="sans-serif" font-size="23.3333" font-weight="bold" lengthAdjust="spacing" textLength="794.9967" x="605.0016" y="39.2253">Camera &#8594; Geology (iPhone &#8594; Vertex AI) &#8212; Reference Architecture</text></g><!--cluster phone--><g class="cluster" data-qualified-name="phone" data-source-line="6" id="ent0002"><rect fill="#F8FAFC" height="465" rx="10" ry="10" style="stroke:#334155;stroke-width:1.6667;" width="738.0167" x="11.6667" y="110.8138"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" font-weight="bold" lengthAdjust="spacing" textLength="227.8874" x="16.6667" y="136.7057">iPhone (on-device)</text></g><!--cluster gcp--><g class="cluster" data-qualified-name="gcp" data-source-line="13" id="ent0007"><rect fill="#F8FAFC" height="626.6667" rx="10" ry="10" style="stroke:#334155;stroke-width:1.6667;" width="1221.9833" x="796.35" y="74.1471"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" font-weight="bold" lengthAdjust="spacing" textLength="139.0088" x="801.35" y="100.0391">GCP (cloud)</text></g><!--entity ui--><g class="entity" data-qualified-name="phone.ui" data-source-line="7" id="ent0003"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="256.4583" x="47.3667" y="461.6638"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="75.7422" x="64.0333" y="500.8891">App UI</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="223.125" x="64.0333" y="528.3695">(question + results)</text></g><!--entity cam--><g class="entity" data-qualified-name="phone.cam" data-source-line="8" id="ent0004"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="212.2412" x="69.4833" y="314.9971"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="178.9079" x="86.15" y="354.2224">Camera capture</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="144.0218" x="86.15" y="381.7029">(1-3 photos)</text></g><!--entity meta--><g class="entity" data-qualified-name="phone.meta" data-source-line="9" id="ent0005"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="274.5394" x="38.3333" y="168.3305"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="241.2061" x="55" y="207.5557">GPS/EXIF + user note</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="108.1104" x="55" y="235.0362">(optional)</text></g><!--entity pre--><g class="entity" data-qualified-name="phone.pre" data-source-line="10" id="ent0006"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="310.1432" x="412.8667" y="319.9971"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="95.2702" x="429.5333" y="359.2224">Preflight</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="276.8099" x="429.5333" y="386.7029">(resize + quality checks)</text></g><!--entity api--><g class="entity" data-qualified-name="gcp.api" data-source-line="14" id="ent0008"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="234.6175" x="823.0167" y="354.9971"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="175.7633" x="839.6833" y="394.2224">API (Cloud Run)</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="201.2842" x="839.6833" y="421.7029">Auth + rate limits</text></g><!--entity gcs--><g class="entity" data-qualified-name="gcp.gcs" data-source-line="15" id="ent0009"><path d="M1185.9833,587.4971 C1185.9833,570.8305 1333.4329,570.8305 1333.4329,570.8305 C1333.4329,570.8305 1480.8824,570.8305 1480.8824,587.4971 L1480.8824,657.4581 C1480.8824,674.1247 1333.4329,674.1247 1333.4329,674.1247 C1333.4329,674.1247 1185.9833,674.1247 1185.9833,657.4581 L1185.9833,587.4971" fill="#EEF2FF" style="stroke:#3730A3;stroke-width:0.8333;"/><path d="M1185.9833,587.4971 C1185.9833,604.1638 1333.4329,604.1638 1333.4329,604.1638 C1333.4329,604.1638 1480.8824,604.1638 1480.8824,587.4971" fill="none" style="stroke:#3730A3;stroke-width:0.8333;"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="45.5729" x="1202.65" y="633.3891">GCS</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="261.5658" x="1202.65" y="660.8695">(image blobs, optional)</text></g><!--entity vlm--><g class="entity" data-qualified-name="gcp.vlm" data-source-line="16" id="ent0010"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="351.6032" x="1157.6333" y="424.9971"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="318.2699" x="1174.3" y="464.2224">Vertex AI multimodal model</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="171.6276" x="1174.3" y="491.7029">(Gemini Vision)</text></g><!--entity rag--><g class="entity" data-qualified-name="gcp.rag" data-source-line="17" id="ent0011"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="325.4443" x="1170.7167" y="278.3305"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="197.8662" x="1187.3833" y="317.5557">RAG Orchestrator</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="292.111" x="1187.3833" y="345.0362">(classification &#8594; retrieval)</text></g><!--entity vs--><g class="entity" data-qualified-name="gcp.vs" data-source-line="18" id="ent0012"><path d="M1609.2333,287.4971 C1609.2333,270.8305 1800.4443,270.8305 1800.4443,270.8305 C1800.4443,270.8305 1991.6552,270.8305 1991.6552,287.4971 L1991.6552,357.4581 C1991.6552,374.1247 1800.4443,374.1247 1800.4443,374.1247 C1800.4443,374.1247 1609.2333,374.1247 1609.2333,357.4581 L1609.2333,287.4971" fill="#EEF2FF" style="stroke:#3730A3;stroke-width:0.8333;"/><path d="M1609.2333,287.4971 C1609.2333,304.1638 1800.4443,304.1638 1800.4443,304.1638 C1800.4443,304.1638 1991.6552,304.1638 1991.6552,287.4971" fill="none" style="stroke:#3730A3;stroke-width:0.8333;"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="137.6986" x="1625.9" y="333.3891">Vector store</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="349.0885" x="1625.9" y="360.8695">(Wikipedia slice / geology refs)</text></g><!--entity obs--><g class="entity" data-qualified-name="gcp.obs" data-source-line="19" id="ent0013"><rect fill="#F8FAFC" height="88.2943" rx="10" ry="10" style="stroke:#334155;stroke-width:0.8333;" width="181.3883" x="1242.7333" y="131.6638"/><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="148.055" x="1259.4" y="170.8891">Observability</text><text fill="#0F172A" font-family="sans-serif" font-size="23.3333" lengthAdjust="spacing" textLength="145.4688" x="1259.4" y="198.3695">(logs, traces)</text></g><!--link cam to pre--><g class="link" data-entity-1="ent0004" data-entity-2="ent0006" data-link-type="dependency" data-source-line="22" id="lnk14"><path d="M282.3,361.6471 C322.45,361.6471 358.9833,361.6471 402.6833,361.6471" fill="none" id="cam-to-pre" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="412.6833,361.6471,397.6833,354.9805,404.35,361.6471,397.6833,368.3138,412.6833,361.6471" style="stroke:#334155;stroke-width:1.6667;"/></g><!--link meta to pre--><g class="link" data-entity-1="ent0005" data-entity-2="ent0006" data-link-type="dependency" data-source-line="23" id="lnk15"><path d="M286.6667,257.3638 C286.6667,294.3805 286.6667,340.8305 286.6667,340.8305 C286.6667,340.8305 337.4333,340.8305 402.5,340.8305" fill="none" id="meta-to-pre" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="412.5,340.8305,397.5,334.1638,404.1667,340.8305,397.5,347.4971,412.5,340.8305" style="stroke:#334155;stroke-width:1.6667;"/></g><!--link ui to pre--><g class="link" data-entity-1="ent0003" data-entity-2="ent0006" data-link-type="dependency" data-source-line="24" id="lnk16"><path d="M293.3333,461.2805 C293.3333,425.9471 293.3333,382.4638 293.3333,382.4638 C293.3333,382.4638 340.2,382.4638 402.1833,382.4638" fill="none" id="ui-to-pre" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="412.1833,382.4638,397.1833,375.7971,403.85,382.4638,397.1833,389.1305,412.1833,382.4638" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="189.541" x="315.0167" y="405.0777">capture + context</text></g><!--link pre to api--><g class="link" data-entity-1="ent0006" data-entity-2="ent0008" data-link-type="dependency" data-source-line="25" id="lnk17"><path d="M723.7167,381.6471 C756.8,381.6471 781.2,381.6471 812.5833,381.6471" fill="none" id="pre-to-api" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="822.5833,381.6471,807.5833,374.9805,814.25,381.6471,807.5833,388.3138,822.5833,381.6471" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="66.9678" x="774.8167" y="350.9277">HTTPS</text><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="182.019" x="774.8167" y="376.4453">(OAuth / API key)</text></g><!--link api to gcs--><g class="link" data-entity-1="ent0008" data-entity-2="ent0009" data-link-type="dependency" data-source-line="27" id="lnk18"><path d="M940,443.7971 C940,508.9805 940,622.4805 940,622.4805 C940,622.4805 1063.7167,622.4805 1175.25,622.4805" fill="none" id="api-to-gcs" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="1185.25,622.4805,1170.25,615.8138,1176.9167,622.4805,1170.25,629.1471,1185.25,622.4805" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="165.4093" x="806.6167" y="645.0944">optional upload</text></g><!--link api to vlm--><g class="link" data-entity-1="ent0008" data-entity-2="ent0010" data-link-type="dependency" data-source-line="28" id="lnk19"><path d="M1058.2667,437.1971 C1089.4833,437.1971 1113.85,437.1971 1147.4167,437.1971" fill="none" id="api-to-vlm" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="1157.4167,437.1971,1142.4167,430.5305,1149.0833,437.1971,1142.4167,443.8638,1157.4167,437.1971" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="193.4342" x="912.85" y="459.8111">classify + features</text><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="152.0475" x="912.85" y="485.3286">(JSON schema)</text></g><!--link vlm to api--><g class="link" data-entity-1="ent0010" data-entity-2="ent0008" data-link-type="dependency" data-source-line="31" id="lnk22"><path d="M1157,431.0971 C1123.5333,431.0971 1099.2667,431.0971 1068.1667,431.0971" fill="none" id="vlm-to-api" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="1058.1667,431.0971,1073.1667,437.7638,1066.5,431.0971,1073.1667,424.4305,1058.1667,431.0971" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="235.9635" x="1109.25" y="425.3777">hypotheses + features</text></g><!--link api to rag--><g class="link" data-entity-1="ent0008" data-entity-2="ent0011" data-link-type="dependency" data-source-line="29" id="lnk20"><path d="M940,354.5138 C940,341.9638 940,331.6638 940,331.6638 C940,331.6638 1051.9,331.6638 1160,331.6638" fill="none" id="api-to-rag" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="1170,331.6638,1155,324.9971,1161.6667,331.6638,1155,338.3305,1170,331.6638" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="247.9606" x="795.2333" y="325.9444">build queries + retrieve</text></g><!--link rag to api--><g class="link" data-entity-1="ent0011" data-entity-2="ent0008" data-link-type="dependency" data-source-line="32" id="lnk23"><path d="M1170.3,343.3305 C1085.0667,343.3305 998.3333,343.3305 998.3333,343.3305 C998.3333,343.3305 998.3333,337.9971 998.3333,344.6305" fill="none" id="rag-to-api" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="998.3333,354.6305,1005,339.6305,998.3333,346.2971,991.6667,339.6305,998.3333,354.6305" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="244.2896" x="1080.3333" y="365.9444">citations + explanation</text></g><!--link rag to vs--><g class="link" data-entity-1="ent0011" data-entity-2="ent0012" data-link-type="dependency" data-source-line="30" id="lnk21"><path d="M1506.7667,322.4805 C1543.0667,322.4805 1561.8667,322.4805 1599.1667,322.4805" fill="none" id="rag-vs" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="1496.7667,322.4805,1511.7667,329.1471,1505.1,322.4805,1511.7667,315.8138,1496.7667,322.4805" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="1609.1667,322.4805,1594.1667,315.8138,1600.8333,322.4805,1594.1667,329.1471,1609.1667,322.4805" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="171.9263" x="1379.6333" y="345.0944">similarity search</text></g><!--link api to ui--><g class="link" data-entity-1="ent0008" data-entity-2="ent0003" data-link-type="dependency" data-source-line="34" id="lnk24"><path d="M822.5667,425.7971 C637.2333,425.7971 298.3333,425.7971 298.3333,425.7971 C298.3333,425.7971 298.3333,432.7971 298.3333,451.1305" fill="none" id="api-to-ui" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="298.3333,461.1305,305,446.1305,298.3333,452.7971,291.6667,446.1305,298.3333,461.1305" style="stroke:#334155;stroke-width:1.6667;"/><text fill="#334155" font-family="sans-serif" font-size="21.6667" lengthAdjust="spacing" textLength="280.7568" x="261.1167" y="448.4111">response JSON + narration</text></g><!--link api to obs--><g class="link" data-entity-1="ent0008" data-entity-2="ent0013" data-link-type="dependency" data-source-line="35" id="lnk25"><path d="M881.6667,354.6638 C881.6667,294.3805 881.6667,194.1471 881.6667,194.1471 C881.6667,194.1471 1100,194.1471 1232.0167,194.1471" fill="none" id="api-to-obs" style="stroke:#334155;stroke-width:1.6667;"/><polygon fill="#334155" points="1242.0167,194.1471,1227.0167,187.4805,1233.6833,194.1471,1227.0167,200.8138,1242.0167,194.1471" style="stroke:#334155;stroke-width:1.6667;"/></g><?plantuml-src PLFBRXD14BplLpGvsGecGjmGGh8YCEQ0hIG43f5GUxQz7dbsPZ8FAmOXSSe78BumNqBtxAw3msLbRtTLLrVrFjDMcLmJV5EkRPrzuNDhggIJ8JZ7bWB2m_rlc94phjd3I2ytpb9vTqqXqHrCvsDu-FK7BcXDWQmYc0QrqObKoe6goj0wGN8GTBD9KEl01UriLNbKMsm8JdhEaREJcdPQqVW4C88lRtzK0091sx2aawdty7b-OqUtcQBmm2cNOpOfTgYiZm7z4Wgzo67WoyaheKwk1oXiZn6pvUNPkw_pzyoS8mMmBWdEUHc7faErbF0OjWoqDh8Zzx8Y_PsOu3QZqMaFQaDgsm_qxChFVzQVdIzXf8pBTLTlbFzlw-KSHkVI0XVPZc_iDAUDR8w9mEXMfrYWw6Nx6XEkC1RgIrQZMvcpCcuLdyFn6esAnvCEeKBBdkhMrMY0dsIOQ4QjjXgkTMIAZc1ddhXtCPt1WW-0qs5rBZ1C6OnHhxN24fZSJg0KDEq66G6R8ztNpES2H7w8zL_qLdkgDK8qV1vm1ar_Z-nvx-hkoIAB5MUtmvKM_vc3stbxrgIeHx0TaWFd3vF9snABf7hua_Nm4ruFzyEUAsVPeLJ9Uwcpvrp_S7Mr5AyN9PapaCIsj1zNbTIbZwtcli5-oDuuh0zLzb6cT4xjUSoQK0P6vlnukVW4aIrjSNm0i6KCM6LjQhuoOZTZ-HIAhrH9-KqXbgcHJyHWa4kCX9nE9VCUrM_stYMEh70Caml7Ou_IgUGdBNJd3LhilkD1KPOknddk8IYYJy5Y25tVq2Qs_mK0?></g></svg>